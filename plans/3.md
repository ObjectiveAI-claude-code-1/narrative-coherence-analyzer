# Implementation Plan: Narrative Coherence Analyzer

## Overview

This document outlines the implementation plan for the `narrative-coherence-analyzer` function, a `vector.function` with fixed output length of 7 that analyzes the narrative structure of startup pitches and produces a probability distribution across seven canonical narrative elements.

---

## 1. Input Schema Structure

```json
{
  "type": "object",
  "description": "A startup pitch to analyze for narrative coherence across seven canonical elements: Problem, Solution, Market, Business Model, Traction, Team, and Vision.",
  "properties": {
    "idea": {
      "description": "The startup pitch in any supported modality or combination thereof",
      "anyOf": [
        {
          "type": "string",
          "description": "A text-based pitch (executive summary, pitch script, written deck content)"
        },
        {
          "type": "image",
          "description": "A visual pitch (slide deck image, infographic, one-pager)"
        },
        {
          "type": "audio",
          "description": "An audio pitch (verbal presentation, podcast appearance, demo day recording)"
        },
        {
          "type": "video",
          "description": "A video pitch (recorded presentation, demo day video, pitch video)"
        },
        {
          "type": "array",
          "description": "A composite pitch combining multiple modalities",
          "minItems": 1,
          "items": {
            "anyOf": [
              {"type": "string"},
              {"type": "image"},
              {"type": "audio"},
              {"type": "video"}
            ]
          }
        }
      ]
    }
  },
  "required": ["idea"]
}
```

### Field Descriptions

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `idea` | string \| image \| audio \| video \| array | Yes | The startup pitch content to analyze. Accepts text, single image, audio, video, or an array combining multiple modalities. |

---

## 2. Input Maps

**No input maps are needed** for this function. The function evaluates a single pitch at a time, not a collection of pitches. All 21 evaluation tasks operate on the same input pitch.

---

## 3. Function Definition Structure

```json
{
  "type": "vector.function",
  "description": "Analyzes the narrative structure of a startup pitch, producing a probability distribution across seven canonical narrative elements: Problem, Solution, Market, Business Model, Traction, Team, and Vision. Each score represents the relative strength of that element in the pitch's overall narrative.",
  "output_length": 7,
  "input_schema": { /* as defined above */ },
  "tasks": [
    // 21 vector.completion tasks for element evaluation (Phase 1)
    // 7 tasks assessing Presence (one per element)
    // 7 tasks assessing Quality (one per element)  
    // 7 tasks assessing Narrative Flow (one per element)
    // Final normalization computed in function output expression
  ]
}
```

### Task Organization (Simplified from ESSAY_TASKS.md)

After analyzing the example functions, I will simplify the architecture. Instead of 29 separate tasks with explicit Phase 2 and Phase 3 computation tasks, I will:

1. **Use 21 `vector.completion` tasks** (3 per element Ã— 7 elements)
2. **Compute raw scores and normalization in the final output expression** using Starlark

This follows the pattern of the example functions which use Starlark output expressions to combine task results.

---

## 4. Task Definitions

### 4.1 Presence Assessment Tasks (7 tasks)

Each presence task evaluates whether a narrative element is explicitly addressed, implied, or absent.

**Task pattern:**
```json
{
  "type": "vector.completion",
  "messages": [
    {
      "role": "system",
      "content": "[System prompt describing presence assessment for specific element]"
    },
    {
      "role": "user", 
      "content": {
        "$starlark": "'Analyze this startup pitch for the presence of [ELEMENT]:\\n\\n' + str(input['idea'])"
      }
    }
  ],
  "responses": [
    "Absent: The [element] is not addressed at all in the pitch",
    "Barely Implied: The [element] can only be inferred with significant assumptions",
    "Implied: The [element] is suggested but not directly stated",
    "Addressed: The [element] is explicitly mentioned and covered",
    "Thoroughly Addressed: The [element] is comprehensively and deliberately covered"
  ],
  "output": {
    "$starlark": "output['scores'][0] * 0.0 + output['scores'][1] * 0.25 + output['scores'][2] * 0.5 + output['scores'][3] * 0.75 + output['scores'][4] * 1.0"
  }
}
```

**Elements to assess:**
1. Problem Presence
2. Solution Presence
3. Market Presence
4. Business Model Presence
5. Traction Presence
6. Team Presence
7. Vision Presence

### 4.2 Quality Assessment Tasks (7 tasks)

Each quality task evaluates how compelling and well-articulated the element is.

**Task pattern:**
```json
{
  "type": "vector.completion",
  "messages": [
    {
      "role": "system",
      "content": "[System prompt with quality criteria for specific element]"
    },
    {
      "role": "user",
      "content": {
        "$starlark": "'Evaluate the quality of the [ELEMENT] articulation in this startup pitch:\\n\\n' + str(input['idea'])"
      }
    }
  ],
  "responses": [
    "Poor: [Element]-specific poor quality description",
    "Weak: [Element]-specific weak quality description",
    "Adequate: [Element]-specific adequate quality description",
    "Strong: [Element]-specific strong quality description",
    "Exceptional: [Element]-specific exceptional quality description"
  ],
  "output": {
    "$starlark": "output['scores'][0] * 0.0 + output['scores'][1] * 0.25 + output['scores'][2] * 0.5 + output['scores'][3] * 0.75 + output['scores'][4] * 1.0"
  }
}
```

### 4.3 Narrative Flow Assessment Tasks (7 tasks)

Each flow task evaluates how well the element connects to other elements.

**Task pattern:**
```json
{
  "type": "vector.completion",
  "messages": [
    {
      "role": "system",
      "content": "[System prompt describing flow/integration criteria for specific element]"
    },
    {
      "role": "user",
      "content": {
        "$starlark": "'Evaluate how well the [ELEMENT] connects to other narrative elements in this startup pitch:\\n\\n' + str(input['idea'])"
      }
    }
  ],
  "responses": [
    "Contradictory: The [element] conflicts with other elements in the pitch",
    "Fragmented: The [element] exists independently without connection to other elements",
    "Connected: The [element] has clear logical links to other elements",
    "Seamless: The [element] flows naturally and reinforces the overall narrative"
  ],
  "output": {
    "$starlark": "output['scores'][0] * 0.0 + output['scores'][1] * 0.33 + output['scores'][2] * 0.67 + output['scores'][3] * 1.0"
  }
}
```

---

## 5. Expressions to Write

### 5.1 User Content Expressions (21 expressions)

Each task needs a user content expression that incorporates the input:

```starlark
# For Presence tasks
"'Analyze this startup pitch for the presence of the PROBLEM element:\\n\\n' + str(input['idea'])"

# For Quality tasks  
"'Evaluate the quality of the SOLUTION articulation in this startup pitch:\\n\\n' + str(input['idea'])"

# For Flow tasks
"'Evaluate how well the MARKET element connects to other narrative elements in this startup pitch:\\n\\n' + str(input['idea'])"
```

### 5.2 Task Output Expressions (21 expressions)

**Presence and Quality tasks (5-level scale):**
```starlark
"output['scores'][0] * 0.0 + output['scores'][1] * 0.25 + output['scores'][2] * 0.5 + output['scores'][3] * 0.75 + output['scores'][4] * 1.0"
```

**Flow tasks (4-level scale):**
```starlark
"output['scores'][0] * 0.0 + output['scores'][1] * 0.33 + output['scores'][2] * 0.67 + output['scores'][3] * 1.0"
```

### 5.3 Final Function Output Expression

The function output expression must:
1. Collect all 21 task outputs
2. Compute 7 raw scores (one per element) using weighted combination
3. Normalize to probability distribution summing to 1.0

**Task output variable naming (by index):**
- Tasks 0-6: Presence scores (Problem, Solution, Market, BusinessModel, Traction, Team, Vision)
- Tasks 7-13: Quality scores (same order)
- Tasks 14-20: Flow scores (same order)

**Raw score computation for each element:**
```starlark
# For element i (where i = 0 to 6):
# presence = tasks[i]
# quality = tasks[i + 7]  
# flow = tasks[i + 14]
# 
# Weighted combination: 40% presence, 35% quality, 25% flow
# With cap: if presence < 0.3, cap raw score at presence level

def compute_raw(presence, quality, flow):
    weighted = presence * 0.4 + quality * 0.35 + flow * 0.25
    if presence < 0.3:
        return min(weighted, presence)
    return weighted
```

**Final normalization expression:**
```starlark
# Compute all 7 raw scores
raw_0 = min(tasks[0] * 0.4 + tasks[7] * 0.35 + tasks[14] * 0.25, tasks[0]) if tasks[0] < 0.3 else tasks[0] * 0.4 + tasks[7] * 0.35 + tasks[14] * 0.25
raw_1 = min(tasks[1] * 0.4 + tasks[8] * 0.35 + tasks[15] * 0.25, tasks[1]) if tasks[1] < 0.3 else tasks[1] * 0.4 + tasks[8] * 0.35 + tasks[15] * 0.25
# ... repeat for all 7 elements

# Sum all raw scores
total = raw_0 + raw_1 + raw_2 + raw_3 + raw_4 + raw_5 + raw_6

# Normalize (with edge case handling for zero sum)
if total < 0.001:
    [1/7, 1/7, 1/7, 1/7, 1/7, 1/7, 1/7]
else:
    [raw_0/total, raw_1/total, raw_2/total, raw_3/total, raw_4/total, raw_5/total, raw_6/total]
```

**Actual Starlark output expression (condensed):**
```starlark
(lambda t: (lambda r: (lambda s: [x/s for x in r] if s > 0.001 else [1/7]*7)(sum(r)))([min(t[i]*0.4+t[i+7]*0.35+t[i+14]*0.25, t[i]) if t[i]<0.3 else t[i]*0.4+t[i+7]*0.35+t[i+14]*0.25 for i in range(7)]))(tasks)
```

---

## 6. System Prompts

### 6.1 Presence Assessment Prompts

**Problem Presence:**
```
You are an expert startup pitch analyst. Your task is to assess whether this pitch explicitly addresses the PROBLEM being solved.

Look for:
- Description of a pain point, challenge, or unmet need
- Quantification of the problem's scope or impact
- Evidence of understanding who experiences this problem
- Specific examples vs. vague abstractions

You must evaluate ONLY the presence of the Problem element, not its quality.
```

**Solution Presence:**
```
You are an expert startup pitch analyst. Your task is to assess whether this pitch explicitly addresses the SOLUTION being offered.

Look for:
- Clear description of what the product or service does
- Key features or capabilities
- Mechanism of action or how it works
- Demonstration or evidence (demo, prototype, screenshots)

You must evaluate ONLY the presence of the Solution element, not its quality.
```

**Market Presence:**
```
You are an expert startup pitch analyst. Your task is to assess whether this pitch explicitly addresses the MARKET opportunity.

Look for:
- Market size (TAM, SAM, SOM)
- Target customer segments
- Market growth or dynamics
- Competitive landscape
- Why now / timing

You must evaluate ONLY the presence of the Market element, not its quality.
```

**Business Model Presence:**
```
You are an expert startup pitch analyst. Your task is to assess whether this pitch explicitly addresses the BUSINESS MODEL.

Look for:
- How the company makes money
- Pricing or monetization mechanisms
- Customer acquisition strategy
- Unit economics
- Path to profitability

You must evaluate ONLY the presence of the Business Model element, not its quality.
```

**Traction Presence:**
```
You are an expert startup pitch analyst. Your task is to assess whether this pitch explicitly addresses TRACTION and proof points.

Look for:
- Quantitative metrics (revenue, users, growth rates)
- Customer testimonials or case studies
- Partnerships or notable customers
- Milestones achieved
- Social proof (investors, press, awards)

You must evaluate ONLY the presence of the Traction element, not its quality.
```

**Team Presence:**
```
You are an expert startup pitch analyst. Your task is to assess whether this pitch explicitly addresses the TEAM and execution capability.

Look for:
- Founder and key team member introductions
- Relevant backgrounds and experiences
- Roles and responsibilities
- Advisors or notable supporters
- Team commitment level

You must evaluate ONLY the presence of the Team element, not its quality.
```

**Vision Presence:**
```
You are an expert startup pitch analyst. Your task is to assess whether this pitch explicitly addresses the VISION for the future.

Look for:
- Description of the future state if successful
- Long-term ambitions
- Potential impact
- Where the journey leads
- Inspiring destination

You must evaluate ONLY the presence of the Vision element, not its quality.
```

### 6.2 Quality Assessment Prompts

**Problem Quality:**
```
You are an expert startup pitch analyst. Your task is to evaluate the QUALITY of how the Problem is articulated in this pitch.

Evaluate:
- Specificity: Is the problem concrete and tangible?
- Urgency: Does the problem demand immediate attention?
- Pain Intensity: Is this a "hair on fire" problem?
- Universality: Does the problem resonate broadly?
- Authenticity: Does the founder demonstrate genuine understanding?

Rate the quality of the Problem articulation, not just whether it is present.
```

**Solution Quality:**
```
You are an expert startup pitch analyst. Your task is to evaluate the QUALITY of how the Solution is articulated in this pitch.

Evaluate:
- Clarity: Can the solution be understood quickly?
- Elegance: Does it feel like the right answer?
- Differentiation: What makes this unique?
- Feasibility: Does it seem achievable?
- Problem-Solution Fit: Does it address the stated problem?
- Demonstrability: Is it shown, not just told?

Rate the quality of the Solution articulation, not just whether it is present.
```

**Market Quality:**
```
You are an expert startup pitch analyst. Your task is to evaluate the QUALITY of how the Market is articulated in this pitch.

Evaluate:
- Size: Is the market large enough?
- Growth: Is the market expanding?
- Accessibility: Can this market be reached?
- Segmentation: Is there understanding of customer segments?
- Timing: Is there a compelling "why now"?
- Competitive Landscape: Is competition accurately characterized?

Rate the quality of the Market articulation, not just whether it is present.
```

**Business Model Quality:**
```
You are an expert startup pitch analyst. Your task is to evaluate the QUALITY of how the Business Model is articulated in this pitch.

Evaluate:
- Clarity: Is monetization immediately understandable?
- Alignment: Does the model align incentives?
- Defensibility: Does it create switching costs or network effects?
- Scalability: Can it scale without proportional cost increases?
- Proven Patterns: Does it follow established patterns?
- Path to Profitability: Is there a clear trajectory?

Rate the quality of the Business Model articulation, not just whether it is present.
```

**Traction Quality:**
```
You are an expert startup pitch analyst. Your task is to evaluate the QUALITY of the Traction evidence in this pitch.

Evaluate:
- Quantitative Evidence: Are there specific, credible numbers?
- Quality of Metrics: Are metrics meaningful vs. vanity?
- Trend Direction: Is traction accelerating?
- Social Proof: Are validators notable and credible?
- Milestones: Are achieved milestones meaningful?
- Customer Testimonials: Do customers express genuine enthusiasm?

Rate the quality of the Traction evidence, not just whether it is present.
```

**Team Quality:**
```
You are an expert startup pitch analyst. Your task is to evaluate the QUALITY of how the Team is presented in this pitch.

Evaluate:
- Relevant Experience: Does the team have domain expertise?
- Complementary Skills: Does the team cover essential functions?
- Track Record: Have they built or scaled companies before?
- Unfair Advantages: Does the team have unique access or insights?
- Cohesion: Does the team seem like a functioning unit?
- Commitment: Is the team fully committed?
- Self-Awareness: Do they acknowledge gaps honestly?

Rate the quality of the Team presentation, not just whether it is present.
```

**Vision Quality:**
```
You are an expert startup pitch analyst. Your task is to evaluate the QUALITY of how the Vision is articulated in this pitch.

Evaluate:
- Ambition: Is the vision big enough to inspire?
- Clarity: Can the future state be visualized?
- Believability: Is the vision achievable?
- Inspiration: Does the vision stir emotion?
- Coherence: Does the vision connect to problem, solution, and traction?
- Uniqueness: Is this a vision only this team could articulate?

Rate the quality of the Vision articulation, not just whether it is present.
```

### 6.3 Flow Assessment Prompts

**Problem Flow:**
```
You are an expert startup pitch analyst. Your task is to evaluate how well the PROBLEM element connects to other narrative elements in this pitch.

Consider:
- Does the Problem naturally lead to the Solution presented?
- Does the Problem's scope align with the Market opportunity claimed?
- Is the Problem framed in a way that makes the Team's involvement logical?
- Does the Problem set stakes that make the Vision meaningful?

Rate the narrative integration of the Problem element.
```

**Solution Flow:**
```
You are an expert startup pitch analyst. Your task is to evaluate how well the SOLUTION element connects to other narrative elements in this pitch.

Consider:
- Does the Solution directly address the Problem stated?
- Does the Solution justify the Market opportunity claimed?
- Does the Solution's complexity match the Team's capabilities?
- Does the Solution serve as a credible path toward the Vision?

Rate the narrative integration of the Solution element.
```

**Market Flow:**
```
You are an expert startup pitch analyst. Your task is to evaluate how well the MARKET element connects to other narrative elements in this pitch.

Consider:
- Does the Market size align with the Problem's scope?
- Does the Market justify the Business Model's revenue potential?
- Does the Market timing align with the Solution's readiness?
- Does the Market opportunity warrant the Vision's ambition?

Rate the narrative integration of the Market element.
```

**Business Model Flow:**
```
You are an expert startup pitch analyst. Your task is to evaluate how well the BUSINESS MODEL element connects to other narrative elements in this pitch.

Consider:
- Does the Business Model logically monetize the Solution?
- Does the Business Model's scale potential match the Market size?
- Does the Business Model align with Traction evidence?
- Is the Business Model consistent with the Vision's scope?

Rate the narrative integration of the Business Model element.
```

**Traction Flow:**
```
You are an expert startup pitch analyst. Your task is to evaluate how well the TRACTION element connects to other narrative elements in this pitch.

Consider:
- Does Traction validate that the Problem is real and Solution works?
- Does Traction support the Market opportunity claimed?
- Does Traction demonstrate the Business Model is viable?
- Does Traction build credibility for the Team's execution ability?

Rate the narrative integration of the Traction element.
```

**Team Flow:**
```
You are an expert startup pitch analyst. Your task is to evaluate how well the TEAM element connects to other narrative elements in this pitch.

Consider:
- Is the Team's expertise aligned with the Problem domain?
- Does the Team have the skills to build the Solution?
- Does the Team's network support the Market access claimed?
- Does the Traction validate the Team's execution ability?
- Is the Team capable of achieving the Vision?

Rate the narrative integration of the Team element.
```

**Vision Flow:**
```
You are an expert startup pitch analyst. Your task is to evaluate how well the VISION element connects to other narrative elements in this pitch.

Consider:
- Does the Vision represent the ultimate resolution of the Problem?
- Does the Vision show where the Solution leads at full potential?
- Does the Vision justify the Market opportunity's importance?
- Does the Vision explain why this Team is on this mission?
- Does the Vision make the current Traction feel like the beginning of something larger?

Rate the narrative integration of the Vision element.
```

---

## 7. Test Inputs

### 7.1 Comprehensive Pitch (All Elements Strong)

```json
{
  "idea": "Every year, 2.3 million people die from hospital-acquired infections, making it the fourth leading cause of death globally. Current hand hygiene compliance in hospitals averages just 40%. We've built SmartSoap: an AI-powered hand hygiene monitoring system using computer vision to track compliance in real-time without wearables. Our sensors cost $50 per room vs. $500+ for competitors, enabling hospital-wide deployment. The hospital infection prevention market is $45B globally, growing 8% annually as regulations tighten. We charge hospitals $2,000/month per 100-bed facility - a 10x ROI given the average HAI costs $35,000 to treat. In 18 months, we've deployed to 47 hospitals, achieving 89% compliance rates (up from 41%), reducing HAIs by 62%. Our team includes Dr. Sarah Chen (former CDC epidemiologist, 15 years in infection control), Marcus Williams (ex-Google ML engineer, built YouTube's recommendation system), and Lisa Park (scaled operations at Theranos competitor that actually worked). We're raising $5M to expand to 500 hospitals by 2026, becoming the standard of care globally and saving 500,000 lives annually."
}
```
**Expected output pattern:** Roughly balanced distribution with all elements between 0.12-0.16

---

### 7.2 Problem-Heavy Pitch (Strong Problem, Weak Everything Else)

```json
{
  "idea": "Did you know that 73% of enterprise software projects fail? Companies waste $260 billion annually on software that never gets used. The average enterprise has 900+ SaaS applications but employees actively use only 40% of them. IT departments spend 30% of their time managing software licenses for tools nobody wants. Shadow IT is rampant because official channels are too slow - the average software procurement takes 6 months. This isn't just inefficiency; it's existential. Companies are drowning in tool sprawl while their competitors move faster. Every failed software project represents not just wasted money but crushed morale, delayed products, and lost market share. The problem is getting worse as AI tools proliferate. We need to fix this."
}
```
**Expected output pattern:** Problem dominates (0.35+), other elements minimal (0.05-0.12)

---

### 7.3 Solution-Focused Technical Pitch

```json
{
  "idea": "Introducing QuantumMesh: a novel distributed computing architecture that uses topological error correction to achieve 99.9999% uptime without redundant hardware. Our proprietary algorithm, published in Nature last month, reduces latency by 340x compared to traditional approaches. The system features: (1) Self-healing network topology that reroutes around failures in <1ms, (2) Quantum-inspired optimization that finds optimal routing paths in O(log n) time, (3) Zero-knowledge proof verification ensuring data integrity without performance overhead, (4) Backwards compatibility with existing TCP/IP infrastructure. We have working prototypes running in our lab achieving 1.2 Tbps throughput on commodity hardware."
}
```
**Expected output pattern:** Solution dominates (0.40+), Problem implied (0.10-0.15), other elements minimal

---

### 7.4 Traction-Led Growth Stage Pitch

```json
{
  "idea": "DataPipe hit $12M ARR in Q3, up from $3M last year - that's 300% YoY growth. We have 340 enterprise customers including Walmart, JP Morgan, and Salesforce. Net revenue retention is 145%. Our last cohort of customers reached payback in 4.2 months. We're the #1 rated data integration tool on G2 with 2,400 reviews averaging 4.8 stars. Forbes named us a 'Cloud 100' company. We just signed our largest deal ever: a $2.4M 3-year contract with a Fortune 50 retailer. Customer testimonial from Walmart's CTO: 'DataPipe saved us 18 months of engineering time and $8M in infrastructure costs.' We've raised $45M to date from Sequoia and Andreessen Horowitz."
}
```
**Expected output pattern:** Traction dominates (0.45+), Business Model implied (0.10-0.15), other elements minimal

---

### 7.5 Vision-Dominant Moonshot Pitch

```json
{
  "idea": "Imagine a world where no one dies waiting for an organ transplant. Where personalized organs are printed on demand using your own cells, eliminating rejection and the need for immunosuppression. We're building that future. Within 10 years, we will print the first functional human heart. Within 20, organ failure will be as treatable as a broken bone. This isn't science fiction - it's the inevitable culmination of bioprinting advances. The first company to achieve this will be worth more than Apple. More importantly, they will save 8,000 lives per day. We are assembling the team and technology to be that company. Join us in ending the organ shortage forever."
}
```
**Expected output pattern:** Vision dominates (0.35+), Problem implied (0.15), Team mentioned (0.12), others minimal

---

### 7.6 Team-Centric Pitch

```json
{
  "idea": "We are the team that will win this market. Our CEO, Jennifer Martinez, built and sold two fintech companies for $400M combined. Our CTO, Dr. Raj Patel, led Google's payments infrastructure serving 2B users. Our COO, Marcus Chen, scaled Stripe's operations from 50 to 5,000 employees. Our Head of Product, Sarah Kim, created Venmo's most-used features. Our advisors include the former CEO of Visa, the CTO of Goldman Sachs, and a Federal Reserve governor. We've worked together before - Raj and Jennifer co-founded our first company. We know this space, we know each other, and we know how to execute. We've each spent 15+ years in financial services. Combined, we have 47 patents in payments technology. We're the only team that can build this."
}
```
**Expected output pattern:** Team dominates (0.45+), others minimal or implied

---

### 7.7 Minimal/Empty Pitch (Edge Case)

```json
{
  "idea": "We're building something cool in the AI space. It's going to be big. Trust us."
}
```
**Expected output pattern:** Near-uniform distribution (approximately [0.14, 0.14, 0.14, 0.14, 0.14, 0.14, 0.14]) due to all elements being equally absent

---

### 7.8 Contradictory/Incoherent Pitch (Edge Case)

```json
{
  "idea": "We're solving the massive problem of enterprise scheduling that affects 50 people globally. Our revolutionary AI can schedule meetings but we're pivoting to become a social network for pets. The market is $900 trillion. We have 10 million users but no revenue because we believe software should be free forever. Our team has no relevant experience but we're very passionate. We'll be profitable next month even though we just started yesterday. Our vision is to stay small and not grow while also becoming bigger than Microsoft."
}
```
**Expected output pattern:** Lower overall scores due to poor flow, but presence scores still moderate. Distribution should show fragmentation.

---

### 7.9 Multi-Modal Test (Array Input)

```json
{
  "idea": [
    "SolarFlow: Clean energy for every home",
    {"$image_placeholder": "pitch_deck_slide.png"},
    "We've installed 10,000 systems generating 50MW of clean energy, saving customers $12M annually."
  ]
}
```
**Expected output pattern:** Should synthesize across modalities - Solution from title, visuals from image, Traction from text.

---

### 7.10 Business Model Detailed Pitch

```json
{
  "idea": "Our SaaS platform uses a usage-based pricing model at $0.10 per API call, with a $500/month minimum commitment. Enterprise tier at $5,000/month includes dedicated support and custom integrations. Current gross margin is 82% with CAC payback of 8 months. We estimate $50 LTV per customer with 15% monthly churn at SMB tier but only 2% at enterprise. Revenue mix is 70% enterprise, 30% SMB. We're projecting $10M ARR within 18 months based on current pipeline of $3M. We have preferred vendor agreements with AWS and Snowflake for 40% cost reductions. Our path to profitability is clear: at 500 enterprise customers, we hit cash flow positive."
}
```
**Expected output pattern:** Business Model dominates (0.40+), Traction present (0.15-0.20), other elements minimal

---

## 8. Implementation Checklist

- [ ] Create function.json with type "vector.function" and output_length 7
- [ ] Define input_schema exactly as specified in SPEC.md
- [ ] Implement 7 Presence assessment tasks (tasks 0-6)
- [ ] Implement 7 Quality assessment tasks (tasks 7-13)
- [ ] Implement 7 Flow assessment tasks (tasks 14-20)
- [ ] Write all 21 system prompts following the patterns above
- [ ] Write all 21 user content expressions using $starlark
- [ ] Write all 21 task output expressions
- [ ] Write the final function output expression for normalization
- [ ] Validate JSON structure
- [ ] Test with all 10 test cases
- [ ] Verify outputs sum to 1.0 within floating point tolerance

---

## 9. Notes on Starlark Limitations

Based on the example functions, Starlark expressions should:
- Use `str(input['idea'])` to handle multi-modal inputs as strings
- Access task outputs using `tasks[i]` where i is the task index (0-20)
- Use `output['scores']` within individual task output expressions
- Avoid complex control flow - use ternary expressions instead
- Ensure all floating point arithmetic produces valid results

The final output expression will be complex but must fit Starlark syntax constraints. May need to use nested lambda functions as shown in the examples.
